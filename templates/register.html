{% extends 'base.html' %}

{% block title %}Register{% endblock %}

{% block content %}
    <h2>Register New User</h2>
    <form action="{{ url_for('register') }}" method="post" enctype="multipart/form-data">
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div class="form-group">
            <label>Upload Image:</label>
            <div id="upload-area" class="file-upload">Drag & Drop or Click to Upload Image</div>
            <input type="file" id="file-input" name="image" accept="image/*">
            <img id="preview" src="" alt="Image preview" style="display: none;">
        </div>
        <div class="form-group">
            <label>Or Capture Image:</label>
            <input type="radio" id="capture" name="capture" value="capture">
            <label for="capture">Capture from Live Camera</label>
        </div>
        <button type="submit">Register</button>
    </form>
    <script>
        document.getElementById('upload-area').addEventListener('click', function() {
            document.getElementById('file-input').click();
        });

        document.getElementById('file-input').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('preview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('upload-area').addEventListener('dragover', function(event) {
            event.preventDefault();
            event.stopPropagation();
            this.style.backgroundColor = '#e9ecef';
        });

        document.getElementById('upload-area').addEventListener('dragleave', function(event) {
            event.preventDefault();
            event.stopPropagation();
            this.style.backgroundColor = '#f9f9f9';
        });

        document.getElementById('upload-area').addEventListener('drop', function(event) {
            event.preventDefault();
            event.stopPropagation();
            this.style.backgroundColor = '#f9f9f9';
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('file-input').files = files;
                document.getElementById('file-input').dispatchEvent(new Event('change'));
            }
        });
    </script>
{% endblock %}
